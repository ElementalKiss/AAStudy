# 항목 15 : 쓸데없이 남은 용량은 "바꿔치기(swap) 묘수"를 써서 없애버리자

# 문제상황

- 컨테이너의 capacity에 비해서 size가 작아서 용량이 쓸데 없이 큰 경우
    + 대회에서 신청자 정보를 담는 `vector<Contestant> cont` 가 있었음
    + 처음엔 100,000명의 신청자가 있었지만...
    + 심사를 거치면서 10명만 남음
    + 따라서 `100,000 - 10`만큼의 용량이 낭비되는 상황

# 수축시켜 맞추기(shrink to fit)

```c++
vector<Contestant>(cont).swap(cont);
```
- 기존의 `cont`를 인자로 받는 복사생성자를 호출한 뒤, 해당 객체에서 기존의 `cont` 객체를 대상으로 swap 호출
- 복사생성자는 요소가 복사되는데 필요한 만큼의 메모리만을 할당하기 때문에, `cont` 객체와 달리 `size == capacity`

# 이 방법은 string 에도 쓸 수 있다

```c++
string s;
/*
 * 문자를 만들고 없애는 복잡한 코드
 */
string(s).swap(s); // shrink to fit
```
- 마찬가지로 string의 capacity가 size 정도로 줄어들었다

# 컨테이너를 비우는 데에도 사용할 수 있다

```c++
vector<Contestant> v;
/*
 * 벡터를 잘 사용하는 코드
 */
vector<Contestant>().swap(v);
```
- 기본생성자로 vector를 생성한 후에 swap 하였다
- 따라서 컨테이너를 완전히 비우고, 라이브러리 구현 코드가 허용하는 최소치로 용량을 줄였다

# 기타

- 두 컨테이너를 swap 하면, 내부의 요소 뿐만 아니라 **반복자**, **포인터**, **참조자**도 모두 바뀐다
- 즉, swap이 일어난 후에도 기존의 컨테이너를 가리키는데 사용하던 반복자, 포인터, 참조자를 그대로 사용해도 된다는 것
